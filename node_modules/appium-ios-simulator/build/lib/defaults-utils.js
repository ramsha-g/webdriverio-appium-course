"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.NSUserDefaults = void 0;
exports.generateDefaultsCommandArgs = generateDefaultsCommandArgs;
exports.toXmlArg = toXmlArg;
require("source-map-support/register");
var _lodash = _interopRequireDefault(require("lodash"));
var _xmldom = require("@xmldom/xmldom");
var _teen_process = require("teen_process");
var _bluebird = _interopRequireDefault(require("bluebird"));
var _logger = _interopRequireDefault(require("./logger"));
function toXmlArg(value, serialize = true) {
  let xmlDoc = null;
  if (_lodash.default.isPlainObject(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString('<dict></dict>', 'text/xml');
    for (const [subKey, subValue] of _lodash.default.toPairs(value)) {
      const keyEl = xmlDoc.createElement('key');
      const keyTextEl = xmlDoc.createTextNode(subKey);
      keyEl.appendChild(keyTextEl);
      xmlDoc.documentElement.appendChild(keyEl);
      const subValueEl = xmlDoc.importNode(toXmlArg(subValue, false), true);
      xmlDoc.documentElement.appendChild(subValueEl);
    }
  } else if (_lodash.default.isArray(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString('<array></array>', 'text/xml');
    for (const subValue of value) {
      const subValueEl = xmlDoc.importNode(toXmlArg(subValue, false), true);
      xmlDoc.documentElement.appendChild(subValueEl);
    }
  } else if (_lodash.default.isBoolean(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString(value ? '<true/>' : '<false/>', 'text/xml');
  } else if (_lodash.default.isInteger(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString(`<integer>${value}</integer>`, 'text/xml');
  } else if (_lodash.default.isNumber(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString(`<real>${value}</real>`, 'text/xml');
  } else if (_lodash.default.isString(value)) {
    xmlDoc = new _xmldom.DOMParser().parseFromString(`<string></string>`, 'text/xml');
    const valueTextEl = xmlDoc.createTextNode(value);
    xmlDoc.documentElement.appendChild(valueTextEl);
  }
  if (!xmlDoc) {
    throw new TypeError(`The defaults value ${JSON.stringify(value)} cannot be written, ` + `because it is not known how to handle its type`);
  }
  return serialize ? new _xmldom.XMLSerializer().serializeToString(xmlDoc.documentElement) : xmlDoc.documentElement;
}
function generateDefaultsCommandArgs(valuesMap, replace = false) {
  const resultArgs = [];
  for (const [key, value] of _lodash.default.toPairs(valuesMap)) {
    try {
      if (!replace && _lodash.default.isPlainObject(value)) {
        const dictArgs = [key, '-dict-add'];
        for (const [subKey, subValue] of _lodash.default.toPairs(value)) {
          dictArgs.push(subKey, toXmlArg(subValue));
        }
        resultArgs.push(dictArgs);
      } else if (!replace && _lodash.default.isArray(value)) {
        const arrayArgs = [key, '-array-add'];
        for (const subValue of value) {
          arrayArgs.push(toXmlArg(subValue));
        }
        resultArgs.push(arrayArgs);
      } else {
        resultArgs.push([key, toXmlArg(value)]);
      }
    } catch (e) {
      if (e instanceof TypeError) {
        _logger.default.warn(e.message);
      } else {
        throw e;
      }
    }
  }
  return resultArgs;
}
class NSUserDefaults {
  constructor(plist) {
    this.plist = plist;
  }
  async asJson() {
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)('plutil', ['-convert', 'json', '-o', '-', this.plist]);
      return JSON.parse(stdout);
    } catch (e) {
      throw new Error(`'${this.plist}' cannot be converted to JSON. Original error: ${e.stderr || e.message}`);
    }
  }
  async update(valuesMap) {
    if (!_lodash.default.isPlainObject(valuesMap)) {
      throw new TypeError(`plist values must be a map. '${valuesMap}' is given instead`);
    }
    if (_lodash.default.isEmpty(valuesMap)) {
      return;
    }
    const commandArgs = generateDefaultsCommandArgs(valuesMap);
    try {
      await _bluebird.default.all(commandArgs.map(args => (0, _teen_process.exec)('defaults', ['write', this.plist, ...args])));
    } catch (e) {
      throw new Error(`Could not write defaults into '${this.plist}'. Original error: ${e.stderr || e.message}`);
    }
  }
}
exports.NSUserDefaults = NSUserDefaults;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbG9kYXNoIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfeG1sZG9tIiwiX3RlZW5fcHJvY2VzcyIsIl9ibHVlYmlyZCIsIl9sb2dnZXIiLCJ0b1htbEFyZyIsInZhbHVlIiwic2VyaWFsaXplIiwieG1sRG9jIiwiXyIsImlzUGxhaW5PYmplY3QiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJzdWJLZXkiLCJzdWJWYWx1ZSIsInRvUGFpcnMiLCJrZXlFbCIsImNyZWF0ZUVsZW1lbnQiLCJrZXlUZXh0RWwiLCJjcmVhdGVUZXh0Tm9kZSIsImFwcGVuZENoaWxkIiwiZG9jdW1lbnRFbGVtZW50Iiwic3ViVmFsdWVFbCIsImltcG9ydE5vZGUiLCJpc0FycmF5IiwiaXNCb29sZWFuIiwiaXNJbnRlZ2VyIiwiaXNOdW1iZXIiLCJpc1N0cmluZyIsInZhbHVlVGV4dEVsIiwiVHlwZUVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsIlhNTFNlcmlhbGl6ZXIiLCJzZXJpYWxpemVUb1N0cmluZyIsImdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyIsInZhbHVlc01hcCIsInJlcGxhY2UiLCJyZXN1bHRBcmdzIiwia2V5IiwiZGljdEFyZ3MiLCJwdXNoIiwiYXJyYXlBcmdzIiwiZSIsImxvZyIsIndhcm4iLCJtZXNzYWdlIiwiTlNVc2VyRGVmYXVsdHMiLCJjb25zdHJ1Y3RvciIsInBsaXN0IiwiYXNKc29uIiwic3Rkb3V0IiwiZXhlYyIsInBhcnNlIiwiRXJyb3IiLCJzdGRlcnIiLCJ1cGRhdGUiLCJpc0VtcHR5IiwiY29tbWFuZEFyZ3MiLCJCIiwiYWxsIiwibWFwIiwiYXJncyIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9saWIvZGVmYXVsdHMtdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IERPTVBhcnNlciwgWE1MU2VyaWFsaXplciB9IGZyb20gJ0B4bWxkb20veG1sZG9tJztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5cbi8qKlxuICogU2VyaWFsaXplcyB0aGUgZ2l2ZW4gdmFsdWUgdG8gcGxpc3QtY29tcGF0aWJsZVxuICogWE1MIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyByZWFkeSBmb3IgZnVydGhlciB1c2FnZVxuICogd2l0aCBgZGVmYXVsdHNgIGNvbW1hbmQgbGluZSB0b29sIGFyZ3VtZW50c1xuICpcbiAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGJlIHNlcmlhbGl6ZWRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gc2VyaWFsaXplIFt0cnVlXSBXaGV0aGVyIHRvIHNlcmlhbGl6ZSB0aGUgcmVzdWx0aW5nXG4gKiBYTUwgdG8gc3RyaW5nIG9yIHRvIHJldHVybiByYXcgSFRNTEVsZW1lbnQgaW5zdGFuY2VcbiAqIEByZXR1cm5zIHtIVE1MRWxlbWVudHxzdHJpbmd9IEVpdGhlciBzdHJpbmcgb3IgcmF3IG5vZGUgcmVwcmVzZW50YXRpb24gb2ZcbiAqIHRoZSBnaXZlbiB2YWx1ZVxuICogQHRocm93cyB7VHlwZUVycm9yfSBJZiBpdCBpcyBub3Qga25vd24gaG93IHRvIHNlcmlhbGl6ZSB0aGUgZ2l2ZW4gdmFsdWVcbiAqL1xuZnVuY3Rpb24gdG9YbWxBcmcgKHZhbHVlLCBzZXJpYWxpemUgPSB0cnVlKSB7XG4gIGxldCB4bWxEb2MgPSBudWxsO1xuXG4gIGlmIChfLmlzUGxhaW5PYmplY3QodmFsdWUpKSB7XG4gICAgeG1sRG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZygnPGRpY3Q+PC9kaWN0PicsICd0ZXh0L3htbCcpO1xuICAgIGZvciAoY29uc3QgW3N1YktleSwgc3ViVmFsdWVdIG9mIF8udG9QYWlycyh2YWx1ZSkpIHtcbiAgICAgIGNvbnN0IGtleUVsID0geG1sRG9jLmNyZWF0ZUVsZW1lbnQoJ2tleScpO1xuICAgICAgY29uc3Qga2V5VGV4dEVsID0geG1sRG9jLmNyZWF0ZVRleHROb2RlKHN1YktleSk7XG4gICAgICBrZXlFbC5hcHBlbmRDaGlsZChrZXlUZXh0RWwpO1xuICAgICAgeG1sRG9jLmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChrZXlFbCk7XG4gICAgICBjb25zdCBzdWJWYWx1ZUVsID0geG1sRG9jLmltcG9ydE5vZGUodG9YbWxBcmcoc3ViVmFsdWUsIGZhbHNlKSwgdHJ1ZSk7XG4gICAgICB4bWxEb2MuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHN1YlZhbHVlRWwpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChfLmlzQXJyYXkodmFsdWUpKSB7XG4gICAgeG1sRG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZygnPGFycmF5PjwvYXJyYXk+JywgJ3RleHQveG1sJyk7XG4gICAgZm9yIChjb25zdCBzdWJWYWx1ZSBvZiB2YWx1ZSkge1xuICAgICAgY29uc3Qgc3ViVmFsdWVFbCA9IHhtbERvYy5pbXBvcnROb2RlKHRvWG1sQXJnKHN1YlZhbHVlLCBmYWxzZSksIHRydWUpO1xuICAgICAgeG1sRG9jLmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChzdWJWYWx1ZUVsKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoXy5pc0Jvb2xlYW4odmFsdWUpKSB7XG4gICAgeG1sRG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh2YWx1ZSA/ICc8dHJ1ZS8+JyA6ICc8ZmFsc2UvPicsICd0ZXh0L3htbCcpO1xuICB9IGVsc2UgaWYgKF8uaXNJbnRlZ2VyKHZhbHVlKSkge1xuICAgIHhtbERvYyA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoYDxpbnRlZ2VyPiR7dmFsdWV9PC9pbnRlZ2VyPmAsICd0ZXh0L3htbCcpO1xuICB9IGVsc2UgaWYgKF8uaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgeG1sRG9jID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhgPHJlYWw+JHt2YWx1ZX08L3JlYWw+YCwgJ3RleHQveG1sJyk7XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyh2YWx1ZSkpIHtcbiAgICB4bWxEb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGA8c3RyaW5nPjwvc3RyaW5nPmAsICd0ZXh0L3htbCcpO1xuICAgIGNvbnN0IHZhbHVlVGV4dEVsID0geG1sRG9jLmNyZWF0ZVRleHROb2RlKHZhbHVlKTtcbiAgICB4bWxEb2MuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHZhbHVlVGV4dEVsKTtcbiAgfVxuXG4gIGlmICgheG1sRG9jKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgVGhlIGRlZmF1bHRzIHZhbHVlICR7SlNPTi5zdHJpbmdpZnkodmFsdWUpfSBjYW5ub3QgYmUgd3JpdHRlbiwgYCArXG4gICAgICBgYmVjYXVzZSBpdCBpcyBub3Qga25vd24gaG93IHRvIGhhbmRsZSBpdHMgdHlwZWApO1xuICB9XG5cbiAgcmV0dXJuIHNlcmlhbGl6ZVxuICAgID8gbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyh4bWxEb2MuZG9jdW1lbnRFbGVtZW50KVxuICAgIDogeG1sRG9jLmRvY3VtZW50RWxlbWVudDtcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZXMgY29tbWFuZCBsaW5lIGFyZ3MgZm9yIHRoZSBgZGVmYXVsdHNgXG4gKiBjb21tYW5kIGxpbmUgdXRpbGl0eSBiYXNlZCBvbiB0aGUgZ2l2ZW4gcHJlZmVyZW5jZSB2YWx1ZXMgbWFwcGluZy5cbiAqIFNlZSBodHRwczovL3NoYWRvd2ZpbGUuaW5vZGUubGluay9ibG9nLzIwMTgvMDYvYWR2YW5jZWQtZGVmYXVsdHMxLXVzYWdlL1xuICogZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsdWVzTWFwIFByZWZlcmVuY2VzIG1hcHBpbmdcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gcmVwbGFjZSBbZmFsc2VdIFdoZXRoZXIgdG8gZ2VuZXJhdGUgYXJndW1lbnRzIHRoYXQgcmVwbGFjZVxuICogY29tcGxleCB0eXBlZCB2YWx1ZXMgbGlrZSBhcnJheXMgb3IgZGljdGlvbmFyaWVzIGluIHRoZSBjdXJyZW50IHBsaXN0IG9yXG4gKiB1cGRhdGUgdGhlbSAodGhlIGRlZmF1bHQgc2V0dGluZ3MpXG4gKiBAcmV0dXJucyB7QXJyYXk8QXJyYXk8c3RyaW5nPj59IEVhY2ggaXRlbSBpbiB0aGUgYXJyYXlcbiAqIGlzIHRoZSBgZGVmYXVsdHMgd3JpdGUgPHBsaXN0PmAgY29tbWFuZCBzdWZmaXhcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVEZWZhdWx0c0NvbW1hbmRBcmdzICh2YWx1ZXNNYXAsIHJlcGxhY2UgPSBmYWxzZSkge1xuICBjb25zdCByZXN1bHRBcmdzID0gW107XG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIF8udG9QYWlycyh2YWx1ZXNNYXApKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghcmVwbGFjZSAmJiBfLmlzUGxhaW5PYmplY3QodmFsdWUpKSB7XG4gICAgICAgIGNvbnN0IGRpY3RBcmdzID0gW2tleSwgJy1kaWN0LWFkZCddO1xuICAgICAgICBmb3IgKGNvbnN0IFtzdWJLZXksIHN1YlZhbHVlXSBvZiBfLnRvUGFpcnModmFsdWUpKSB7XG4gICAgICAgICAgZGljdEFyZ3MucHVzaChzdWJLZXksIHRvWG1sQXJnKHN1YlZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0QXJncy5wdXNoKGRpY3RBcmdzKTtcbiAgICAgIH0gZWxzZSBpZiAoIXJlcGxhY2UgJiYgXy5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICBjb25zdCBhcnJheUFyZ3MgPSBba2V5LCAnLWFycmF5LWFkZCddO1xuICAgICAgICBmb3IgKGNvbnN0IHN1YlZhbHVlIG9mIHZhbHVlKSB7XG4gICAgICAgICAgYXJyYXlBcmdzLnB1c2godG9YbWxBcmcoc3ViVmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHRBcmdzLnB1c2goYXJyYXlBcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdEFyZ3MucHVzaChba2V5LCB0b1htbEFyZyh2YWx1ZSldKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIFR5cGVFcnJvcikge1xuICAgICAgICBsb2cud2FybihlLm1lc3NhZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdEFyZ3M7XG59XG5cblxuY2xhc3MgTlNVc2VyRGVmYXVsdHMge1xuICBjb25zdHJ1Y3RvciAocGxpc3QpIHtcbiAgICB0aGlzLnBsaXN0ID0gcGxpc3Q7XG4gIH1cblxuICAvKipcbiAgICogUmVhZHMgdGhlIGNvbnRlbnQgb2YgdGhlIGdpdmVuIHBsaXN0IGZpbGUgdXNpbmcgcGx1dGlsIGNvbW1hbmQgbGluZSB0b29sXG4gICAqIGFuZCBzZXJpYWxpemVzIGl0IHRvIGEgSlNPTiByZXByZXNlbnRhdGlvblxuICAgKlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgc2VyaWFsaXplZCBwbGlzdCBjb250ZW50XG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3IgZHVyaW5nIHNlcmlhbGl6YXRpb25cbiAgICovXG4gIGFzeW5jIGFzSnNvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygncGx1dGlsJywgWyctY29udmVydCcsICdqc29uJywgJy1vJywgJy0nLCB0aGlzLnBsaXN0XSk7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShzdGRvdXQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7dGhpcy5wbGlzdH0nIGNhbm5vdCBiZSBjb252ZXJ0ZWQgdG8gSlNPTi4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5zdGRlcnIgfHwgZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSBjb250ZW50IG9mIHRoZSBnaXZlbiBwbGlzdCBmaWxlLlxuICAgKiBJZiB0aGUgcGxpc3QgZG9lcyBub3QgZXhpc3QgeWV0IHRoZW4gaXQgaXMgZ29pbmcgdG8gYmUgY3JlYXRlZC5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IHZhbHVlc01hcCBNYXBwaW5nIG9mIHByZWZlcmVuY2UgdmFsdWVzIHRvIHVwZGF0ZS5cbiAgICogSWYgYW55IG9mIGl0ZW0gdmFsdWVzIGFyZSBvZiBkaWN0aW9uYXJ5IHR5cGUgdGhlbiBvbmx5IHRoZSBmaXJzdCBsZXZlbCBkaWN0aW9uYXJ5IGdldHNcbiAgICogdXBkYXRlZC4gRXZlcnl0aGluZyBiZWxvdyB0aGlzIGxldmVsIHdpbGwgYmUgcmVwbGFjZWQuIFRoaXMgaXMgdGhlIGtub3duIGxpbWl0YXRpb25cbiAgICogb2YgdGhlIGBkZWZhdWx0c2AgY29tbWFuZCBsaW5lIHRvb2wuIEEgd29ya2Fyb3VuZCBmb3IgaXQgd291bGQgYmUgdG8gcmVhZCB0aGUgY3VycmVudFxuICAgKiBwcmVmZXJlbmNlcyBtYXBwaW5nIGZpcnN0IGFuZCBtZXJnZSBpdCB3aXRoIHRoaXMgdmFsdWUuXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgdXBkYXRpbmcgdGhlIHBsaXN0XG4gICAqL1xuICBhc3luYyB1cGRhdGUgKHZhbHVlc01hcCkge1xuICAgIGlmICghXy5pc1BsYWluT2JqZWN0KHZhbHVlc01hcCkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYHBsaXN0IHZhbHVlcyBtdXN0IGJlIGEgbWFwLiAnJHt2YWx1ZXNNYXB9JyBpcyBnaXZlbiBpbnN0ZWFkYCk7XG4gICAgfVxuICAgIGlmIChfLmlzRW1wdHkodmFsdWVzTWFwKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmRBcmdzID0gZ2VuZXJhdGVEZWZhdWx0c0NvbW1hbmRBcmdzKHZhbHVlc01hcCk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IEIuYWxsKGNvbW1hbmRBcmdzLm1hcCgoYXJncykgPT4gZXhlYygnZGVmYXVsdHMnLCBbJ3dyaXRlJywgdGhpcy5wbGlzdCwgLi4uYXJnc10pKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3Qgd3JpdGUgZGVmYXVsdHMgaW50byAnJHt0aGlzLnBsaXN0fScuIE9yaWdpbmFsIGVycm9yOiAke2Uuc3RkZXJyIHx8IGUubWVzc2FnZX1gKTtcbiAgICB9XG4gIH1cbn1cblxuXG5leHBvcnQge1xuICBOU1VzZXJEZWZhdWx0cyxcbiAgdG9YbWxBcmcsIGdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyxcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxhQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxPQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFjQSxTQUFTSyxRQUFRQSxDQUFFQyxLQUFLLEVBQUVDLFNBQVMsR0FBRyxJQUFJLEVBQUU7RUFDMUMsSUFBSUMsTUFBTSxHQUFHLElBQUk7RUFFakIsSUFBSUMsZUFBQyxDQUFDQyxhQUFhLENBQUNKLEtBQUssQ0FBQyxFQUFFO0lBQzFCRSxNQUFNLEdBQUcsSUFBSUcsaUJBQVMsQ0FBQyxDQUFDLENBQUNDLGVBQWUsQ0FBQyxlQUFlLEVBQUUsVUFBVSxDQUFDO0lBQ3JFLEtBQUssTUFBTSxDQUFDQyxNQUFNLEVBQUVDLFFBQVEsQ0FBQyxJQUFJTCxlQUFDLENBQUNNLE9BQU8sQ0FBQ1QsS0FBSyxDQUFDLEVBQUU7TUFDakQsTUFBTVUsS0FBSyxHQUFHUixNQUFNLENBQUNTLGFB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