"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.connectPort = connectPort;
exports.connectPortSSL = connectPortSSL;
exports.getConnectedDevices = getConnectedDevices;
exports.getDeviceInfo = getDeviceInfo;
exports.getDeviceName = getDeviceName;
exports.getDeviceTime = getDeviceTime;
exports.getOSVersion = getOSVersion;
exports.startLockdownSession = startLockdownSession;
require("source-map-support/register");
var _usbmux = _interopRequireWildcard(require("./usbmux"));
var _sslHelper = require("./ssl-helper");
var _lodash = _interopRequireDefault(require("lodash"));
var _logger = _interopRequireDefault(require("./logger"));
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }
const LOCKDOWN_REQUEST = {
  DEVICE_TIME: {
    Key: 'TimeIntervalSince1970'
  },
  DEVICE_UTC_OFFSET: {
    Key: 'TimeZoneOffsetFromUTC'
  },
  DEVICE_TIME_ZONE: {
    Key: 'TimeZone'
  },
  DEVICE_VERSION: {
    Key: 'ProductVersion'
  },
  DEVICE_NAME: {
    Key: 'DeviceName'
  }
};
async function getConnectedDevices(socket = null) {
  let usbmux;
  try {
    usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  } catch (e) {
    _logger.default.debug(e);
    return [];
  }
  try {
    const devices = await usbmux.listDevices();
    const udids = devices.map(device => device.Properties.SerialNumber);
    return _lodash.default.uniq(udids);
  } finally {
    usbmux.close();
  }
}
async function getOSVersion(udid, socket = null) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const lockdown = await usbmux.connectLockdown(udid);
    return await lockdown.getValue(LOCKDOWN_REQUEST.DEVICE_VERSION);
  } finally {
    usbmux.close();
  }
}
async function getDeviceName(udid, socket = null) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const lockdown = await usbmux.connectLockdown(udid);
    return await lockdown.getValue(LOCKDOWN_REQUEST.DEVICE_NAME);
  } finally {
    usbmux.close();
  }
}
async function getDeviceInfo(udid, socket = null) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const lockdown = await usbmux.connectLockdown(udid);
    return await lockdown.getValue();
  } finally {
    usbmux.close();
  }
}
async function getDeviceTime(udid, socket = null) {
  const lockdown = await startLockdownSession(udid, socket);
  try {
    return {
      timestamp: await lockdown.getValue(LOCKDOWN_REQUEST.DEVICE_TIME),
      utcOffset: (await lockdown.getValue(LOCKDOWN_REQUEST.DEVICE_UTC_OFFSET)) / 60,
      timeZone: await lockdown.getValue(LOCKDOWN_REQUEST.DEVICE_TIME_ZONE)
    };
  } finally {
    lockdown.close();
  }
}
async function startLockdownSession(udid, socket = null) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const pairRecord = await usbmux.readPairRecord(udid);
    if (!pairRecord) {
      throw new Error(`Could not find a pair record for device '${udid}'. Please first pair with the device`);
    }
    const lockdown = await usbmux.connectLockdown(udid);
    await lockdown.startSession(pairRecord.HostID, pairRecord.SystemBUID);
    lockdown.enableSessionSSL(pairRecord.HostPrivateKey, pairRecord.HostCertificate);
    return lockdown;
  } catch (e) {
    usbmux.close();
    throw e;
  }
}
async function connectPortSSL(udid, port, socket = null, handshakeOnly = false) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const device = await usbmux.findDevice(udid);
    if (!device) {
      throw new Error(`Could not find the expected device '${udid}'`);
    }
    const pairRecord = await usbmux.readPairRecord(udid);
    if (!pairRecord) {
      throw new Error(`Could not find a pair record for device '${udid}'. Please first pair with the device`);
    }
    const socket = await usbmux.connect(device.Properties.DeviceID, port, undefined);
    return handshakeOnly ? await (0, _sslHelper.enableSSLHandshakeOnly)(socket, pairRecord.HostPrivateKey, pairRecord.HostCertificate) : (0, _sslHelper.upgradeToSSL)(socket, pairRecord.HostPrivateKey, pairRecord.HostCertificate);
  } catch (e) {
    usbmux.close();
    throw e;
  }
}
async function connectPort(udid, port, socket = null) {
  const usbmux = new _usbmux.default(socket || (await (0, _usbmux.getDefaultSocket)()));
  try {
    const device = await usbmux.findDevice(udid);
    if (!device) {
      throw new Error(`Could not find the expected device ${udid}`);
    }
    return await usbmux.connect(device.Properties.DeviceID, port, undefined);
  } catch (e) {
    usbmux.close();
    throw e;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNibXV4IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJyZXF1aXJlIiwiX3NzbEhlbHBlciIsIl9sb2Rhc2giLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX2xvZ2dlciIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIm5vZGVJbnRlcm9wIiwiV2Vha01hcCIsImNhY2hlQmFiZWxJbnRlcm9wIiwiY2FjaGVOb2RlSW50ZXJvcCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY2FjaGUiLCJoYXMiLCJnZXQiLCJuZXdPYmoiLCJoYXNQcm9wZXJ0eURlc2NyaXB0b3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImRlc2MiLCJzZXQiLCJMT0NLRE9XTl9SRVFVRVNUIiwiREVWSUNFX1RJTUUiLCJLZXkiLCJERVZJQ0VfVVRDX09GRlNFVCIsIkRFVklDRV9USU1FX1pPTkUiLCJERVZJQ0VfVkVSU0lPTiIsIkRFVklDRV9OQU1FIiwiZ2V0Q29ubmVjdGVkRGV2aWNlcyIsInNvY2tldCIsInVzYm11eCIsIlVzYm11eCIsImdldERlZmF1bHRTb2NrZXQiLCJlIiwibG9nIiwiZGVidWciLCJkZXZpY2VzIiwibGlzdERldmljZXMiLCJ1ZGlkcyIsIm1hcCIsImRldmljZSIsIlByb3BlcnRpZXMiLCJTZXJpYWxOdW1iZXIiLCJfIiwidW5pcSIsImNsb3NlIiwiZ2V0T1NWZXJzaW9uIiwidWRpZCIsImxvY2tkb3duIiwiY29ubmVjdExvY2tkb3duIiwiZ2V0VmFsdWUiLCJnZXREZXZpY2VOYW1lIiwiZ2V0RGV2aWNlSW5mbyIsImdldERldmljZVRpbWUiLCJzdGFydExvY2tkb3duU2Vzc2lvbiIsInRpbWVzdGFtcCIsInV0Y09mZnNldCIsInRpbWVab25lIiwicGFpclJlY29yZCIsInJlYWRQYWlyUmVjb3JkIiwiRXJyb3IiLCJzdGFydFNlc3Npb24iLCJIb3N0SUQiLCJTeXN0ZW1CVUlEIiwiZW5hYmxlU2Vzc2lvblNTTCIsIkhvc3RQcml2YXRlS2V5IiwiSG9zdENlcnRpZmljYXRlIiwiY29ubmVjdFBvcnRTU0wiLCJwb3J0IiwiaGFuZHNoYWtlT25seSIsImZpbmREZXZpY2UiLCJjb25uZWN0IiwiRGV2aWNlSUQiLCJ1bmRlZmluZWQiLCJlbmFibGVTU0xIYW5kc2hha2VPbmx5IiwidXBncmFkZVRvU1NMIiwiY29ubmVjdFBvcnQiXSwic291cmNlcyI6WyIuLi8uLi9saWIvdXRpbGl0aWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2JtdXgsIHsgZ2V0RGVmYXVsdFNvY2tldCB9IGZyb20gJy4vdXNibXV4JztcbmltcG9ydCB7IHVwZ3JhZGVUb1NTTCwgZW5hYmxlU1NMSGFuZHNoYWtlT25seSB9IGZyb20gJy4vc3NsLWhlbHBlcic7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zYW1kbWFyc2hhbGwvaU9TLUludGVybmFscy9ibG9iL21hc3Rlci9sb2NrYm90L2xvY2tib3QvbG9ja2Rvd25fa2V5cy5oXG5jb25zdCBMT0NLRE9XTl9SRVFVRVNUID0ge1xuICBERVZJQ0VfVElNRTogeyBLZXk6ICdUaW1lSW50ZXJ2YWxTaW5jZTE5NzAnIH0sXG4gIERFVklDRV9VVENfT0ZGU0VUOiB7IEtleTogJ1RpbWVab25lT2Zmc2V0RnJvbVVUQycgfSxcbiAgREVWSUNFX1RJTUVfWk9ORTogeyBLZXk6ICdUaW1lWm9uZScgfSxcbiAgREVWSUNFX1ZFUlNJT046IHsgS2V5OiAnUHJvZHVjdFZlcnNpb24nIH0sXG4gIERFVklDRV9OQU1FOiB7IEtleTogJ0RldmljZU5hbWUnIH1cbn07XG5cblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIHVkaWRzIG9mIHRoZSBjb25uZWN0ZWQgZGV2aWNlc1xuICpcbiAqIEBwYXJhbSB7aW1wb3J0KCduZXQnKS5Tb2NrZXQ/fSBzb2NrZXQgdGhlIHNvY2tldCBvZiB1c2JtdXhkLiBJdCB3aWxsIGRlZmF1bHQgdG8gL3Zhci9ydW4vdXNibXV4ZCBpZiBpdCBpcyBub3QgcGFzc2VkXG4gKiBAcmV0dXJucyB7QXJyYXkuPHN0cmluZz59IFRoZSBsaXN0IG9mIGRldmljZSBzZXJpYWwgbnVtYmVycyAodWRpZCkgb3JcbiAqIGFuIGVtcHR5IGxpc3QgaWYgbm8gZGV2aWNlcyBhcmUgY29ubmVjdGVkXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldENvbm5lY3RlZERldmljZXMgKHNvY2tldCA9IG51bGwpIHtcbiAgbGV0IHVzYm11eDtcbiAgdHJ5IHtcbiAgICB1c2JtdXggPSBuZXcgVXNibXV4KHNvY2tldCB8fCBhd2FpdCBnZXREZWZhdWx0U29ja2V0KCkpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKGUpO1xuICAgIHJldHVybiBbXTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IGRldmljZXMgPSBhd2FpdCB1c2JtdXgubGlzdERldmljZXMoKTtcbiAgICBjb25zdCB1ZGlkcyA9IGRldmljZXMubWFwKChkZXZpY2UpID0+IGRldmljZS5Qcm9wZXJ0aWVzLlNlcmlhbE51bWJlcik7XG4gICAgcmV0dXJuIF8udW5pcSh1ZGlkcyk7XG4gIH0gZmluYWxseSB7XG4gICAgdXNibXV4LmNsb3NlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIG9zIHZlcnNpb24gb2YgdGhlIGRldmljZVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIERldmljZSBVRElEXG4gKiBAcGFyYW0ge2ltcG9ydCgnbmV0JykuU29ja2V0P30gc29ja2V0IHRoZSBzb2NrZXQgb2YgdXNibXV4ZC4gSXQgd2lsbCBkZWZhdWx0IHRvIC92YXIvcnVuL3VzYm11eGQgaWYgaXQgaXMgbm90IHBhc3NlZFxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0T1NWZXJzaW9uICh1ZGlkLCBzb2NrZXQgPSBudWxsKSB7XG4gIGNvbnN0IHVzYm11eCA9IG5ldyBVc2JtdXgoc29ja2V0IHx8IGF3YWl0IGdldERlZmF1bHRTb2NrZXQoKSk7XG4gIHRyeSB7XG4gICAgLy8gbG9ja2Rvd24gZG9lc24ndCBuZWVkIHRvIGJlIGNsb3NlZCBzaW5jZSBpdCB1c2VzIHRoZSBzYW1lIHNvY2tldCB1c2JtdXggdXNlc1xuICAgIGNvbnN0IGxvY2tkb3duID0gYXdhaXQgdXNibXV4LmNvbm5lY3RMb2NrZG93bih1ZGlkKTtcbiAgICByZXR1cm4gYXdhaXQgbG9ja2Rvd24uZ2V0VmFsdWUoTE9DS0RPV05fUkVRVUVTVC5ERVZJQ0VfVkVSU0lPTik7XG4gIH0gZmluYWxseSB7XG4gICAgdXNibXV4LmNsb3NlKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIG5hbWUgb2YgdGhlIGRldmljZVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIERldmljZSBVRElEXG4gKiBAcGFyYW0ge2ltcG9ydCgnbmV0JykuU29ja2V0P30gc29ja2V0IHRoZSBzb2NrZXQgb2YgdXNibXV4ZC4gSXQgd2lsbCBkZWZhdWx0IHRvIC92YXIvcnVuL3VzYm11eGQgaWYgaXQgaXMgbm90IHBhc3NlZFxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlTmFtZSAodWRpZCwgc29ja2V0ID0gbnVsbCkge1xuICBjb25zdCB1c2JtdXggPSBuZXcgVXNibXV4KHNvY2tldCB8fCBhd2FpdCBnZXREZWZhdWx0U29ja2V0KCkpO1xuICB0cnkge1xuICAgIC8vIGxvY2tkb3duIGRvZXNuJ3QgbmVlZCB0byBiZSBjbG9zZWQgc2luY2UgaXQgdXNlcyB0aGUgc2FtZSBzb2NrZXQgdXNibXV4IHVzZXNcbiAgICBjb25zdCBsb2NrZG93biA9IGF3YWl0IHVzYm11eC5jb25uZWN0TG9ja2Rvd24odWRpZCk7XG4gICAgcmV0dXJuIGF3YWl0IGxvY2tkb3duLmdldFZhbHVlKExPQ0tET1dOX1JFUVVFU1QuREVWSUNFX05BTUUpO1xuICB9IGZpbmFsbHkge1xuICAgIHVzYm11eC5jbG9zZSgpO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyBhbGwgYXZhaWxhYmxlIGRldmljZSB2YWx1ZXNcbiAqIEBwYXJhbSB7c3RyaW5nfSB1ZGlkIERldmljZSBVRElEXG4gKiBAcGFyYW0ge2ltcG9ydCgnbmV0JykuU29ja2V0P30gc29ja2V0IHRoZSBzb2NrZXQgb2YgdXNibXV4ZC4gSXQgd2lsbCBkZWZhdWx0IHRvIC92YXIvcnVuL3VzYm11eGQgaWYgaXQgaXMgbm90IHBhc3NlZFxuICogQHJldHVybnMge29iamVjdH0gUmV0dXJucyBhdmFpbGFibGUgZGVmYXVsdCBkZXZpY2UgdmFsdWVzIHZpYSBsb2NrZG93bi5cbiAqIGUuZy5cbiAqIHtcbiAqICAgXCJCYXNlYmFuZENlcnRJZFwiPT4zODQwMTQ5NTI4LFxuICogICBcIkJhc2ViYW5kS2V5SGFzaEluZm9ybWF0aW9uXCI9PlxuICogICAgIHtcIkFLZXlTdGF0dXNcIj0+MixcbiAqICAgICBcIlNLZXlIYXNoXCI9PntcbiAqICAgICAgIFwidHlwZVwiPT5cIkJ1ZmZlclwiLFxuICogICAgICAgXCJkYXRhXCI9PlsxODcsIDIzOSwgLi4uLl19LFxuICogICAgIFwiU0tleVN0YXR1c1wiPT4wfSxcbiAqICAgXCJCYXNlYmFuZFNlcmlhbE51bWJlclwiPT57XCJ0eXBlXCI9PlwiQnVmZmVyXCIsIFwiZGF0YVwiPT5bLi4uXX0sXG4gKiAgIFwiQmFzZWJhbmRWZXJzaW9uXCI9PlwiMTEuMDEuMDJcIixcbiAqICAgXCJCb2FyZElkXCI9PjIsXG4gKiAgIFwiQnVpbGRWZXJzaW9uXCI9PlwiMTlDNTZcIixcbiAqICAgXCJDUFVBcmNoaXRlY3R1cmVcIj0+XCJhcm02NFwiLFxuICogICBcIkNoaXBJRFwiPT4zMjc2OCxcbiAqICAgXCJEZXZpY2VDbGFzc1wiPT5cImlQaG9uZVwiLFxuICogICBcIkRldmljZUNvbG9yXCI9PlwiI2M4Y2FjYVwiLFxuICogICBcIkRldmljZU5hbWVcIj0+XCJrYXp1XCIsXG4gKiAgIFwiRGllSURcIj0+MTExMTExMTExMTExMSxcbiAqICAgXCJIYXJkd2FyZU1vZGVsXCI9PlwiTjY5dUFQXCIsXG4gKiAgIFwiSGFzU2lEUFwiPT50cnVlLFxuICogICBcIlBhcnRpdGlvblR5cGVcIj0+XCJHVUlEX3BhcnRpdGlvbl9zY2hlbWVcIixcbiAqICAgXCJQcm9kdWN0TmFtZVwiPT5cImlQaG9uZSBPU1wiLFxuICogICBcIlByb2R1Y3RUeXBlXCI9PlwiaVBob25lOCw0XCIsXG4gKiAgIFwiUHJvZHVjdFZlcnNpb25cIj0+XCIxNS4yXCIsXG4gKiAgIFwiUHJvZHVjdGlvblNPQ1wiPT50cnVlLFxuICogICBcIlByb3RvY29sVmVyc2lvblwiPT5cIjJcIixcbiAqICAgXCJTdXBwb3J0ZWREZXZpY2VGYW1pbGllc1wiPT5bMV0sXG4gKiAgIFwiVGVsZXBob255Q2FwYWJpbGl0eVwiPT50cnVlLFxuICogICBcIlVuaXF1ZUNoaXBJRFwiPT4xMTExMTExMTExMTExLFxuICogICBcIlVuaXF1ZURldmljZUlEXCI9PlwiYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYVwiLFxuICogICBcIldpRmlBZGRyZXNzXCI9PlwiMDA6MDA6MDA6MDA6MDA6MDBcIlxuICogfVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXREZXZpY2VJbmZvICh1ZGlkLCBzb2NrZXQgPSBudWxsKSB7XG4gIGNvbnN0IHVzYm11eCA9IG5ldyBVc2JtdXgoc29ja2V0IHx8IGF3YWl0IGdldERlZmF1bHRTb2NrZXQoKSk7XG4gIHRyeSB7XG4gICAgY29uc3QgbG9ja2Rvd24gPSBhd2FpdCB1c2JtdXguY29ubmVjdExvY2tkb3duKHVkaWQpO1xuICAgIHJldHVybiBhd2FpdCBsb2NrZG93bi5nZXRWYWx1ZSgpO1xuICB9IGZpbmFsbHkge1xuICAgIHVzYm11eC5jbG9zZSgpO1xuICB9XG59XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gRGV2aWNlVGltZVxuICpcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB0aW1lc3RhbXAgVW5peCB0aW1lc3RhbXAgaW4gc2Vjb25kcyBzaW5jZSAxOTcwLTAxLTAxVDAwOjAwOjAwWlxuICogQHByb3BlcnR5IHtudW1iZXJ9IHV0Y09mZnNldCBUaGUgZGlmZmVyZW5jZSBpbiBtaW51dGVzIGJldHdlZW4gdGhlIFVUQyB0aW1lIGFuZCB0aGUgbG9jYWwgZGV2aWNlIHRpbWUuXG4gKiBDYW4gYmUgbmVnYXRpdmUuXG4gKiBAcHJvcGVydHkge3N0cmluZ30gdGltZVpvbmUgVGltZSB6b25lIG5hbWUgY29uZmlndXJlZCBvbiB0aGUgZGV2aWNlLCBmb3IgZXhhbXBsZSBgRXVyb3BlL1BhcmlzYFxuICovXG5cbi8qKlxuICogUmV0cmlldmVzIHRoZSBsb2NhbCB0aW1lIGZyb20gdGhlIGRldmljZSB1bmRlciB0ZXN0XG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgRGV2aWNlIFVESURcbiAqIEBwYXJhbSB7aW1wb3J0KCduZXQnKS5Tb2NrZXQ/fSBzb2NrZXQgdGhlIHNvY2tldCBvZiB1c2JtdXhkLiBJdCB3aWxsIGRlZmF1bHQgdG8gL3Zhci9ydW4vdXNibXV4ZCBpZiBpdCBpcyBub3QgcGFzc2VkXG4gKiBAcmV0dXJucyB7RGV2aWNlVGltZX1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlVGltZSAodWRpZCwgc29ja2V0ID0gbnVsbCkge1xuICBjb25zdCBsb2NrZG93biA9IGF3YWl0IHN0YXJ0TG9ja2Rvd25TZXNzaW9uKHVkaWQsIHNvY2tldCk7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHRpbWVzdGFtcDogYXdhaXQgbG9ja2Rvd24uZ2V0VmFsdWUoTE9DS0RPV05fUkVRVUVTVC5ERVZJQ0VfVElNRSksXG4gICAgICAvLyBBcHBsZSByZXR1cm5zIHV0Y09mZnNldCBpbiBzZWNvbmRzIHdoaWNoIGRvZXNudCBjb21wbHkgd2l0aCB0aGUgZ2VuZXJhbCBzdGFuZGFyZFxuICAgICAgdXRjT2Zmc2V0OiBhd2FpdCBsb2NrZG93bi5nZXRWYWx1ZShMT0NLRE9XTl9SRVFVRVNULkRFVklDRV9VVENfT0ZGU0VUKSAvIDYwLFxuICAgICAgdGltZVpvbmU6IGF3YWl0IGxvY2tkb3duLmdldFZhbHVlKExPQ0tET1dOX1JFUVVFU1QuREVWSUNFX1RJTUVfWk9ORSksXG4gICAgfTtcbiAgfSBmaW5hbGx5IHtcbiAgICBsb2NrZG93bi5jbG9zZSgpO1xuICB9XG59XG5cbi8qKlxuICogU3RhcnRzIGEgbG9ja2Rvd24gc2Vzc2lvbiBvbiB0aGUgZ2l2ZW4gZGV2aWNlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgRGV2aWNlIFVESURcbiAqIEBwYXJhbSB7aW1wb3J0KCduZXQnKS5Tb2NrZXQ/fSBzb2NrZXQgdGhlIHNvY2tldCBvZiB1c2JtdXhkLiBJdCB3aWxsIGRlZmF1bHQgdG8gL3Zhci9ydW4vdXNibXV4ZCBpZiBpdCBpcyBub3QgcGFzc2VkXG4gKiBAcmV0dXJucyB7TG9ja2Rvd259XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0TG9ja2Rvd25TZXNzaW9uICh1ZGlkLCBzb2NrZXQgPSBudWxsKSB7XG4gIGNvbnN0IHVzYm11eCA9IG5ldyBVc2JtdXgoc29ja2V0IHx8IGF3YWl0IGdldERlZmF1bHRTb2NrZXQoKSk7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFpclJlY29yZCA9IGF3YWl0IHVzYm11eC5yZWFkUGFpclJlY29yZCh1ZGlkKTtcbiAgICBpZiAoIXBhaXJSZWNvcmQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgYSBwYWlyIHJlY29yZCBmb3IgZGV2aWNlICcke3VkaWR9Jy4gUGxlYXNlIGZpcnN0IHBhaXIgd2l0aCB0aGUgZGV2aWNlYCk7XG4gICAgfVxuICAgIC8vIGxvY2tkb3duIGRvZXNuJ3QgbmVlZCB0byBiZSBjbG9zZWQgc2luY2UgaXQgdXNlcyB0aGUgc2FtZSBzb2NrZXQgdXNibXV4IHVzZXNcbiAgICBjb25zdCBsb2NrZG93biA9IGF3YWl0IHVzYm11eC5jb25uZWN0TG9ja2Rvd24odWRpZCk7XG4gICAgYXdhaXQgbG9ja2Rvd24uc3RhcnRTZXNzaW9uKHBhaXJSZWNvcmQuSG9zdElELCBwYWlyUmVjb3JkLlN5c3RlbUJVSUQpO1xuICAgIGxvY2tkb3duLmVuYWJsZVNlc3Npb25TU0wocGFpclJlY29yZC5Ib3N0UHJpdmF0ZUtleSwgcGFpclJlY29yZC5Ib3N0Q2VydGlmaWNhdGUpO1xuICAgIHJldHVybiBsb2NrZG93bjtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHVzYm11eC5jbG9zZSgpO1xuICAgIHRocm93IGU7XG4gIH1cbn1cblxuLyoqXG4gKiBDb25uZWN0cyB0byBhIGdpdmVuIHBvcnQgd2l0aCB0aGUgY2VydHMgYW5kIGtleXMgdXNlZCBpbiB0aGUgcGFpcmluZyBwcm9jZXNzXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVkaWQgRGV2aWNlIFVESURcbiAqIEBwYXJhbSB7bnVtYmVyfSBwb3J0IFBvcnQgdG8gY29ubmVjdFxuICogQHBhcmFtIHtpbXBvcnQoJ25ldCcpLlNvY2tldD99IHNvY2tldCB0aGUgc29ja2V0IG9mIHVzYm11eGQuIEl0IHdpbGwgZGVmYXVsdCB0byAvdmFyL3J1bi91c2JtdXhkIGlmIGl0IGlzIG5vdCBwYXNzZWRcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaGFuZHNoYWtlT25seSBvbmx5IGhhbmRzaGFrZSBhbmQgcmV0dXJuIHRoZSBpbml0aWFsIHNvY2tldFxuICogQHJldHVybnMge3Rscy5UTFNTb2NrZXR8T2JqZWN0fSBUaGUgc29ja2V0IG9yIHRoZSBvYmplY3QgcmV0dXJuZWQgaW4gdGhlIGNhbGxiYWNrIGlmIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBleGlzdHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29ubmVjdFBvcnRTU0wgKHVkaWQsIHBvcnQsIHNvY2tldCA9IG51bGwsIGhhbmRzaGFrZU9ubHkgPSBmYWxzZSkge1xuICBjb25zdCB1c2JtdXggPSBuZXcgVXNibXV4KHNvY2tldCB8fCBhd2FpdCBnZXREZWZhdWx0U29ja2V0KCkpO1xuICB0cnkge1xuICAgIGNvbnN0IGRldmljZSA9IGF3YWl0IHVzYm11eC5maW5kRGV2aWNlKHVkaWQpO1xuICAgIGlmICghZGV2aWNlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIHRoZSBleHBlY3RlZCBkZXZpY2UgJyR7dWRpZH0nYCk7XG4gICAgfVxuICAgIGNvbnN0IHBhaXJSZWNvcmQgPSBhd2FpdCB1c2JtdXgucmVhZFBhaXJSZWNvcmQodWRpZCk7XG4gICAgaWYgKCFwYWlyUmVjb3JkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIGEgcGFpciByZWNvcmQgZm9yIGRldmljZSAnJHt1ZGlkfScuIFBsZWFzZSBmaXJzdCBwYWlyIHdpdGggdGhlIGRldmljZWApO1xuICAgIH1cbiAgICBjb25zdCBzb2NrZXQgPSBhd2FpdCB1c2JtdXguY29ubmVjdChkZXZpY2UuUHJvcGVydGllcy5EZXZpY2VJRCwgcG9ydCwgdW5kZWZpbmVkKTtcbiAgICByZXR1cm4gaGFuZHNoYWtlT25seSA/XG4gICAgICBhd2FpdCBlbmFibGVTU0xIYW5kc2hha2VPbmx5KHNvY2tldCwgcGFpclJlY29yZC5Ib3N0UHJpdmF0ZUtleSwgcGFpclJlY29yZC5Ib3N0Q2VydGlmaWNhdGUpIDpcbiAgICAgIHVwZ3JhZGVUb1NTTChzb2NrZXQsIHBhaXJSZWNvcmQuSG9zdFByaXZhdGVLZXksIHBhaXJSZWNvcmQuSG9zdENlcnRpZmljYXRlKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHVzYm11eC5jbG9zZSgpO1xuICAgIHRocm93IGU7XG4gIH1cbn1cblxuLyoqXG4gKiBDb25uZWN0cyB0byBhIGdpdmVuIHBvcnRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdWRpZCBEZXZpY2UgVURJRFxuICogQHBhcmFtIHtudW1iZXJ9IHBvcnQgUG9ydCB0byBjb25uZWN0XG4gKiBAcGFyYW0ge2ltcG9ydCgnbmV0JykuU29ja2V0P30gc29ja2V0IHRoZSBzb2NrZXQgb2YgdXNibXV4ZC4gSXQgd2lsbCBkZWZhdWx0IHRvIC92YXIvcnVuL3VzYm11eGQgaWYgaXQgaXMgbm90IHBhc3NlZFxuICogQHJldHVybnMge25ldC5Tb2NrZXR8T2JqZWN0fSBUaGUgc29ja2V0IG9yIHRoZSBvYmplY3QgcmV0dXJuZWQgaW4gdGhlIGNhbGxiYWNrIGlmIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBleGlzdHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gY29ubmVjdFBvcnQgKHVkaWQsIHBvcnQsIHNvY2tldCA9IG51bGwpIHtcbiAgY29uc3QgdXNibXV4ID0gbmV3IFVzYm11eChzb2NrZXQgfHwgYXdhaXQgZ2V0RGVmYXVsdFNvY2tldCgpKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBkZXZpY2UgPSBhd2FpdCB1c2JtdXguZmluZERldmljZSh1ZGlkKTtcbiAgICBpZiAoIWRldmljZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCB0aGUgZXhwZWN0ZWQgZGV2aWNlICR7dWRpZH1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHVzYm11eC5jb25uZWN0KGRldmljZS5Qcm9wZXJ0aWVzLkRldmljZUlELCBwb3J0LCB1bmRlZmluZWQpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdXNibXV4LmNsb3NlKCk7XG4gICAgdGhyb3cgZTtcbiAgfVxufVxuXG5leHBvcnQge1xuICBnZXRDb25uZWN0ZWREZXZpY2VzLCBnZXRPU1ZlcnNpb24sIGdldERldmljZU5hbWUsIGdldERldmljZVRpbWUsXG4gIHN0YXJ0TG9ja2Rvd25TZXNzaW9uLCBjb25uZWN0UG9ydCwgY29ubmVjdFBvcnRTU0wsIGdldERldmljZUluZm9cbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsdUJBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFVBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLE9BQUEsR0FBQUMs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